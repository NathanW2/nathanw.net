---
layout: post
title: One of my favorite features of QGIS - Rule based styling.
tags:
- gis
- map-rendering
- mapping
- Open Source
- OSS
- qgis
- Quantum GIS
- styling
- thematics
status: publish
type: post
published: true
meta:
  _edit_last: '4008903'
  superawesome: 'false'
  _wpas_mess: ! 'One of my favorite features of QGIS - Rule based styling.: http://wp.me/pjIwZ-aa'
  jabber_published: '1307315411'
  email_notification: '1307315412'
  reddit: a:2:{s:5:"count";s:1:"0";s:4:"time";s:10:"1335517914";}
  _wpas_done_twitter: '1'
  tagazine-media: a:7:{s:7:"primary";s:53:"http://woostuff.files.wordpress.com/2011/06/rules.png";s:6:"images";a:3:{s:53:"http://woostuff.files.wordpress.com/2011/06/rules.png";a:6:{s:8:"file_url";s:53:"http://woostuff.files.wordpress.com/2011/06/rules.png";s:5:"width";s:3:"734";s:6:"height";s:3:"627";s:4:"type";s:5:"image";s:4:"area";s:6:"460218";s:9:"file_path";s:0:"";}s:58:"http://woostuff.files.wordpress.com/2011/06/rulesfinal.png";a:6:{s:8:"file_url";s:58:"http://woostuff.files.wordpress.com/2011/06/rulesfinal.png";s:5:"width";s:3:"675";s:6:"height";s:3:"633";s:4:"type";s:5:"image";s:4:"area";s:6:"427275";s:9:"file_path";s:0:"";}s:59:"http://woostuff.files.wordpress.com/2011/06/rulesfinal2.png";a:6:{s:8:"file_url";s:59:"http://woostuff.files.wordpress.com/2011/06/rulesfinal2.png";s:5:"width";s:3:"680";s:6:"height";s:3:"637";s:4:"type";s:5:"image";s:4:"area";s:6:"433160";s:9:"file_path";s:0:"";}}s:6:"videos";a:0:{}s:11:"image_count";s:1:"3";s:6:"author";s:7:"4008903";s:7:"blog_id";s:7:"4699413";s:9:"mod_stamp";s:19:"2011-06-06
    00:44:54";}
---
One of my favorite features of QGIS is the rule based rendering.

[caption id="attachment_631" align="aligncenter" width="630" caption="QGIS rule based rendering dialog"]<a href="http://woostuff.files.wordpress.com/2011/06/rules.png"><img class="size-full wp-image-631" title="rules" src="http://woostuff.files.wordpress.com/2011/06/rules.png" alt="QGIS rule based rendering dialog" width="630" height="538" /></a>[/caption]

If you're using MapInfo think of thematics + queries but on steroids. Rule based rendering allows you to you set, well, rules on what gets rendered and how.  The rules are based on a simple SQL style query language that's built into QGIS.

Take for example the above screen shot.   The screen shot is from a current project I am doing in QGIS to clean up our current stormwater/drainage layer.  The layer is a in a bit of a mess at the moment so I needed a way to visualize what I have cleaned up and what I haven't, so enter QGIS rule based styling.

For example: A pipe that has an upstream and downstream invert and is part of the trunk (main) network is then considered valid (for this situation anyway), so I created the following rule:

[sourcecode language="SQL"]
network_type = 'Trunk' AND Description != 'Drainage Imaginary Pipe' AND (US_Invert &gt; 0 AND DS_Invert &gt; 0)
[/sourcecode]

We also have little connecting pipes that I don't want to include in valid trunk  as they are only used to connect pits to pipes and are just cosmetic, I have excluded them by adding "<strong>Description !='Drainage Imaginary Pipe'</strong>" to the above filter.

Next I wanted to show invalid trunk network pipes (ones without an up or downstream invert), so we just invert the last condition and swap the last AND for a OR:

[sourcecode language="SQL"]
network_type = 'Trunk' AND Description != 'Drainage Imaginary Pipe' AND (NOT US_Invert &gt; 0 OR NOT DS_Invert &gt; 0)
[/sourcecode]

I also need to show but no highlight the non trunk pipes and the connecting pipes, so I made the next two rules and set their styles to a light gray:

[sourcecode language="SQL"]
NOT network_type = 'Trunk' AND NOT Description = 'Drainage Imaginary Pipe'
[/sourcecode]
[sourcecode language="SQL"]
Description = 'Drainage Imaginary Pipe'
[/sourcecode]

Finally I want to show pipe direction on all pipes but not the connecting pipes, again as they are just cosmetic:

[sourcecode language="SQL"]
Description != 'Drainage Imaginary Pipe'
[/sourcecode]

You will also note in the screenshot above that I have a max zoom scales set on the last three rules, this is because when I zoom out all that info becomes overwhelming at that scale and distracts from showing the invalid parts of the main trunk line.

So after all that, the results:

[caption id="attachment_650" align="aligncenter" width="630" caption="Map rendered using rules"]<a href="http://woostuff.files.wordpress.com/2011/06/rulesfinal.png"><img class="size-full wp-image-650" title="rulesfinal" src="http://woostuff.files.wordpress.com/2011/06/rulesfinal.png" alt="Screenshot of rules applied" width="630" height="590" /></a>[/caption]

and if I zoom out pass 5,000:

[caption id="attachment_651" align="aligncenter" width="630" caption="Map rendered when zoomed out pass 5,000"]<a href="http://woostuff.files.wordpress.com/2011/06/rulesfinal2.png"><img class="size-full wp-image-651" title="rulesfinal2" src="http://woostuff.files.wordpress.com/2011/06/rulesfinal2.png" alt="Screenshot of rules applied, zoomed past 5,000" width="630" height="590" /></a>[/caption]

I think you can see how this rule based rendering could be very powerful, in fact I have about four different rule sets I use with the drainage layer to show different things to different people.

The rules I have shown above are pretty simple, you can go pretty crazy and use them to render OpenStreetMap data: <a href="http://www.youtube.com/watch?v=NBBYtH2svw0">http://www.youtube.com/watch?v=NBBYtH2svw0</a>

The worst part about the rule based rendering is that I have gotten so used to their power that I feel crippled when I go back to MapInfo and try to do styling :)

Happy mapping.

<strong><em>What is your favorite QGIS feature?</em></strong>
