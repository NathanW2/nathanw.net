---
layout: post
title: Generating a Gource source commit history visualization for QGIS (Quantum GIS)
tags:
- git
- Gource
- mapping
- Open Source
- qgis
- Quantum GIS
status: publish
type: post
published: true
meta:
  superawesome: 'false'
  _edit_last: '4008903'
  jabber_published: '1294045195'
  reddit: a:2:{s:5:"count";i:0;s:4:"time";i:1346265489;}
  email_notification: '1294045197'
  _wpas_done_twitter: '1'
---
A couple of days I found a pretty cool open source project for visualizing the history of version controlled code.  The project is called Gource and can be found here: <a href="http://code.google.com/p/gource/">http://code.google.com/p/gource/</a> On the videos wiki page there are a few videos of other projects that have used gource to generate cool videos of their commit history so I thought I should make one for QGIS.

After downloading and building the latest source for Gource and fetching the current trunk of QGIS following these instructions: <a href="http://spatialgalaxy.net/2010/12/27/contributing-to-qgis-using-git/">http://spatialgalaxy.net/2010/12/27/contributing-to-qgis-using-git/</a> I ran the following in my terminal on my Ubuntu machine, with my current directory being the download git repo from the above instructions:
<pre>  gource --title "Quantum GIS" --logo images\icons\qgis-icon.png \
  --hide filenames --date-format "%d, %B %Y" --seconds-per-day 0.15 \
  --highlight-all-users --auto-skip-seconds 0.5 --file-idle-time 0 --max-files 999999999 \
  --multi-sampling --stop-at-end --elasticity 0.1 -b 000000 \
  --disable-progress --user-friction .2 --output-ppm-stream - | \
  ffmpeg -an -threads 4 -y -b 3000K -vb 8000000 -r 60 -f image2pipe \
  -vcodec ppm -i - -vcodec libx264 -vpre libx264-medium qgis.mp4</pre>
Don't worry I know it looks crazy but it's really not that bad.  I'll break it down.
<ul>
	<li>--title "Quantum GIS" <strong><em>Well, yeah, adds a title to the project.</em></strong></li>
	<li><span style="font-family:Consolas, Monaco, 'Courier New', Courier, monospace;line-height:18px;font-size:12px;white-space:pre;">--logo images/icons/qgis-icon.png </span><strong><em><span style="line-height:18px;font-size:12px;white-space:pre;">Adds a icon watermark</span></em></strong></li>
	<li><span style="font-family:Consolas, Monaco, 'Courier New', Courier, monospace;line-height:18px;font-size:12px;white-space:pre;">--hide filenames </span><em><strong><span style="line-height:18px;font-size:12px;white-space:pre;"><span style="font-size:small;"><span style="font-size:12px;line-height:18px;white-space:pre;">This hides the filenames of the files being committed .  I hide these because it makes it pretty hard to see.</span></span></span></strong></em></li>
	<li><span style="font-family:Consolas, Monaco, 'Courier New', Courier, monospace;line-height:18px;font-size:12px;white-space:pre;">--date-format "%d, %B %Y" <strong><em>Formats the date at the top of the video.</em></strong></span></li>
	<li><span style="font-family:Consolas, Monaco, 'Courier New', Courier, monospace;line-height:18px;font-size:12px;white-space:pre;">--seconds-per-day 0.15 </span><strong><em><span style="line-height:18px;font-size:12px;white-space:pre;">How many seconds represent a day.  The lower this is the fast a day goes by, meaning me commits in less time.</span></em></strong></li>
	<li><span style="font-family:Consolas, Monaco, 'Courier New', Courier, monospace;line-height:18px;font-size:12px;white-space:pre;">--highlight-all-users </span><strong><em><span style="line-height:18px;font-size:12px;white-space:pre;">Highlights all the users all the time.</span></em></strong></li>
	<li><span style="font-family:Consolas, Monaco, 'Courier New', Courier, monospace;line-height:18px;font-size:12px;white-space:pre;">--auto-skip-seconds 0.5 </span><strong><em><span style="line-height:18px;font-size:12px;white-space:pre;">If there are no commits for this time it will skip to the next commit.</span></em></strong></li>
	<li><span style="font-family:Consolas, Monaco, 'Courier New', Courier, monospace;line-height:18px;font-size:12px;white-space:pre;">--file-idle-time 0 </span><strong><em><span style="line-height:18px;font-size:12px;white-space:pre;">How long before the file disappears from the video, 0 means never good for seeing the full file tree.</span></em></strong></li>
	<li><span style="font-family:Consolas, Monaco, 'Courier New', Courier, monospace;line-height:18px;font-size:12px;white-space:pre;">--stop-at-end </span><strong><em><span style="line-height:18px;font-size:12px;white-space:pre;">Stops the video at the end of all the commits.</span></em></strong></li>
	<li><span style="font-family:Consolas, Monaco, 'Courier New', Courier, monospace;line-height:18px;font-size:12px;white-space:pre;">-b 000000 </span><strong><em><span style="font-size:small;"><span style="font-size:12px;line-height:18px;white-space:pre;">The background colour, in this case black.</span></span></em></strong></li>
	<li><span style="font-family:Consolas, Monaco, 'Courier New', Courier, monospace;line-height:18px;font-size:12px;white-space:pre;">--output-ppm-stream - </span><strong><em><span style="line-height:18px;font-size:12px;white-space:pre;">Tells gource to output the result ppm stream to STDOUT, which is then piped ( | ) into the ffmpeg</span></em></strong></li>
</ul>
That is a quick overview of some of the gource arguments, running grouce -H in your terminal will print out the full list.  I'm not going to go into the ffmpeg arguments because frankly I don't understand them very well and video isn't really my thing.  I'm sure there are ffmpeg experts that would be able to do it better then what I have.

After running the above commands in my terminal window and letting it do its thing, I had a resulting mp4 file which I then uploaded to YouTube.

Below is the video that I uploaded to YouTube, which took about 5 hours due to my very very slow (read 138kb/s) upload speed.  The video is about 8 years of QGIS development in just over 9 minutes.

As it's a bit hard to see in the video due to the quality, each cluster of files is a directory and the branches show the folder hierarchy.

[youtube=http://www.youtube.com/watch?v=-NILKRiMtcU]

Direct link to video: <a href="http://www.youtube.com/watch?v=-NILKRiMtcU">http://www.youtube.com/watch?v=-NILKRiMtcU</a>

Happy new year and happy coding :)
