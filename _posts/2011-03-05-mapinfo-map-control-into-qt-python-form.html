---
layout: post
title: MapInfo map control into Qt Python form
tags:
- gis
- mapinfo
- MapInfo
- mapinfo interop
- mapinfo ole
- MapInfo Professional
- Mapinfo Programming
- mapping
- Open Source
- python
status: publish
type: post
published: true
meta:
  superawesome: 'false'
  _edit_last: '4008903'
  jabber_published: '1299326382'
  reddit: a:2:{s:5:"count";i:0;s:4:"time";i:1346638577;}
  _wpas_mess: ! 'MapInfo map control into Qt Python form #mapinfo #python #gis #mapping:'
  email_notification: '1299326383'
  _wpas_done_twitter: '1'
---
Tonight for a bit of fun, or shits and jiggles as we say here, I thought I would try and embed a MapInfo map control into a Qt python widget (although I should be studying, but it's Saturday night) .

Turns out it is pretty easy!

pls send me teh codez? OK here you go.

[sourcecode language="python"]
from PyQt4.QtCore import *
from PyQt4.QtGui import *
from win32com.client import Dispatch
import sys

app = QApplication(sys.argv)
app.setAttribute(Qt.AA_NativeWindows,True)
wnd = QMainWindow()
wnd.resize(400, 400)
widget = QWidget()
wnd.setCentralWidget(widget)
wnd.show()

handle = int(widget.winId())
mapinfo = Dispatch(&quot;MapInfo.Application&quot;)
mapinfo.do('Set Next Document Parent %s Style 1' % handle)
mapinfo.do('Open Table &quot;D:\GIS\MAPS\Property.TAB&quot;')
mapinfo.do('Map from Property')

app.exec_()
[/sourcecode]

The above code will load MapInfo and open the property layer into the Qt Widget control, with the result below.

[caption id="attachment_528" align="aligncenter" width="416" caption="MapInfo map in python Qt based form "]<a href="http://woostuff.files.wordpress.com/2011/03/mapinfo.png"><img class="size-full wp-image-528" title="mapinfo" src="http://woostuff.files.wordpress.com/2011/03/mapinfo.png" alt="" width="416" height="438" /></a>[/caption]
<p style="text-align:left;">So this means you don't "always" have to write your MapInfo based apps in C# or C++; of course I already knew this as anything that can use OLE and provide a native window handle to MapInfo will work, I just never tried it.</p>
